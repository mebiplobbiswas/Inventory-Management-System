@model PagedList.IPagedList<Logistic_Inventory.Models.Products>
@using PagedList.Mvc;
@using System.Globalization;
<link href="~/Content/PagedList.css" rel="stylesheet" type="text/css" />

@{
    ViewBag.Title = "Index";
    int i = 1;
    var temp = "";
    ViewBag.page = "products";
    var hide = "hide";
}

 





<div class="modal fade" id="ProductModal" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
    <div class="modal-dialog  " role="document">
        <div class="modal-content">
            <div class="modal-header">

                <button type="button" class="close text-danger" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>

            <div class="modal-body">

                <div class="col-md-12 ml-auto mr-auto">
                    <div class="card card-upgrade">

                        <div class="card-body">



                            <p class="description">
                                Search Product By Category
                            </p>
                        </div>
                        <p></p>
                        <div class="card-description">
 
                            @using (Html.BeginForm())
                            {
 
                                <div class="form-group">
                                    <div class="col-md-12">
                                        <select class="form-control" style="max-width:700px" name="catId" id="catId">
                                            <option value="" selected="selected">Select All</option>

                                            @foreach (var item in ViewBag.categories)
                                            {

                                                <option value="@item.id">@item.category.CatName - @item.SubCatName</option>
                                            }


                                        </select>
                                    </div>
                                </div>
 
                                <br />
                                <div class="form-group">
                                    <div class="col-md-12">
                                        <button class="btn btn-default btn-block" type="submit">Search</button>

                                    </div>

                                </div>
                            }

                        </div>


                    </div>
                </div>
            </div>
 
        </div>
       
    </div>
</div>

 
<div class="header bg-primary-grey pb-6">
    <div class="container-fluid">
        <div class="header-body">
            <div class="row align-items-center py-4">
                <div class="col-lg-6 col-7">
                    <h6 class="h2 text-white d-inline-block mb-0"> Product Categories</h6>
                    <nav aria-label="breadcrumb" class="d-none d-md-inline-block ml-md-4">
                        <ol class="breadcrumb breadcrumb-links breadcrumb-dark">
                            <li class="breadcrumb-item"><a href="@Url.Content("~/home")"><i class="fas fa-home"></i></a></li>
                            <li class="breadcrumb-item"><a href="@Url.Content("~/products")">Products</a></li>
                            <li class="breadcrumb-item active" aria-current="page">List</li>
                        </ol>
                    </nav>
                </div>
                <div class="col-lg-6 col-5 text-right">
               

                    <a class="btn btn-default" href="@Url.Content("~/Products/create")" style="color:white"><i class="tim-icons icon-app"></i> &nbsp;Add New </a>


                    <button class="btn btn-default" id="modal" data-toggle="modal" data-target="#ProductModal">
                        <i class="tim-icons icon-zoom-split"></i> Search
                    </button>



                    <button class="btn btn-default" id="printNow"><i class="fa fa-print" aria-hidden="true"></i> Print</button>
                </div>
            </div>
        </div>
    </div>
</div>


<!-- Page content -->
<div class="container-fluid mt--6">
    <div class="row justify-content-center">
        <div class=" col ">
            <div class="card">
                
                <div class="card-body">
                    <div class="row icon-examples">

                        <table class="table align-items-center table-hover table-bordered" style="font-size:14px;text-align:center" id="tbl">
                            <thead class="thead-light">
                                <tr style="background-color:#ddd;">
                                    <th>SL</th>
                                    <th>Image</th>
                                    <th style="text-align:left">
                                        Product Name
                                    </th>



                                    <th style="text-align:left">
                                        Code
                                    </th>
            

                                    <th>
                                        Unit
                                    </th>


                                    <th>
                                        Production  Cost
                                    </th>

                                    <th>
                                        Selling  Price
                                    </th>




                                    <th class="no-print"></th>
                                </tr>
                                </thead>
                            <tbody>
                                @foreach (var item in Model)
                                {

                                    @*if (item.SubCategories.SubCatName != temp)
                                    {
                                        temp = item.SubCategories.SubCatName;

                                        <tr style="background-color:#e9ecef;text-align:left"> <td colspan="8"><span class="badge badge-secondary"> <i class="ni ni-book-bookmark"></i>   @temp  </span></td></tr>
                                    }*@

                            <tr id="row_@item.id">
                                <td>@i</td>

                                <td><i class="ni ni-app" style="font-size: 30px;"></i></td>

                                <td style="text-align:left">
                                    <b>@Html.DisplayFor(modelItem => item.ProductName)   </b>
                                </td>
               

                                <td style="text-align:left">
                                    @Html.DisplayFor(modelItem => item.ProductCode)
                                </td>



                                <td>
                                    @Html.DisplayFor(modelItem => item.Units.UnitShortName)


                                </td>
                                <td>
                                    <b> @Html.DisplayFor(modelItem => item.UnitPrice)</b>
                                </td>

                                <td>
                                    <b> @Html.DisplayFor(modelItem => item.SellingUnitPrice)</b>
                                </td>




                                <td class="no-print ">
                                    <div class="btn-group btn-group-toggle float-left  @if (item.id == 55) { @hide} " data-toggle="buttons">

                                        <label class="btn btn-sm btn-default btn-simple active" onclick="edit(@item.id)">


                                            <input type="radio" name="options" checked="">
                                            <span class="d-none d-sm-block d-md-block d-lg-block d-xl-block">Edit</span>
                                            <span class="d-block d-sm-none">
                                                <i class="fa fa-edit"></i>
                                            </span>

                                        </label>

                                        <label class="btn btn-sm btn-default btn-simple" id="1" onclick="details(@item.id)">
                                            <input type="radio" class="d-none d-sm-none" name="options">
                                            <span class="d-none d-sm-block d-md-block d-lg-block d-xl-block">Details</span>
                                            <span class="d-block d-sm-none">
                                                <i class="tim-icons icon-notes"></i>
                                            </span>
                                        </label>
                                        <button class="btn btn-sm btn-default btn-simple" id="2" onclick="deletes(@item.id)">
                                            <input type="radio" class="d-none" name="options">
                                            <span class="d-none d-sm-block d-md-block d-lg-block d-xl-block">Delete</span>
                                            <span class="d-block d-sm-none">
                                                <i class="tim-icons icon-simple-remove"></i>
                                            </span>
                                        </button>
                                    </div>


                                </td>

                            </tr>
                                    i++;
                                }

                            </tbody>
                            
                        </table>


                        Page @(Model.PageCount < Model.PageNumber ? 0 : Model.PageNumber) of @Model.PageCount

 

                        @Html.PagedListPager(Model, page => Url.Action("index",
                            new { page, catId = ViewBag.catID }))


                    </div>
                </div>
            </div>
        </div>
    </div>


</div>


<style>
    .badge
    {
        font-size:17px;
    }
</style> 

<script>

    var width = window.innerWidth || document.documentElement.clientWidth || document.body.clientWidth;


    if (width < 900) {
        $("table").addClass("table-responsive");
    }

    function edit(id) {
        window.location.href = "/products/Edit/" + id;

    }

    function details(id) {
        window.location.href = "/products/details/" + id;

    }

    function deletes(id) {
        // window.location.href = "/Categories/delete/" + id;
        var con = confirm('Are you sure you want to delete this product ?');
        if (con) {
            
            var url = "/Api/DeleteProduct?id=" + id;
            $.get(url, function (data) {

                console.log(data);
                var Status = data["status"];
                var Code = parseInt(data["code"]);


                $("#row_" + id).remove();




                return true;
            });

        } else {
           
            return false;
        }

        return false;

    }
</script>


<script>

    $("#printNow").click(function () {

        var path = window.location.origin + "Content/bootstrap.min.css";
        var toPrint = document.getElementById('tbl');

        var popupWin = window.open('', '', 'toolbar=yes,scrollbars=yes,resizable=yes,width=800,height=800,location=no,left=200px');
        popupWin.document.open();
        popupWin.document.write('<html><head><title>Purchase Report </title><style>h1{font-size:20px} h4{font-size:14px}  .no-print{display: none;} .table > thead > tr > th, .table > tbody > tr > th, .table > tfoot > tr > th, .table > thead > tr > td, .table > tbody > tr > td, .table > tfoot > tr > td{ }a[href]:after {content: none !important;}      </style> <link rel="stylesheet" type="text/css"   href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" />  <link href="/Content/site.css" rel="stylesheet"/></head>');

        popupWin.document.write('<body onload="window.print();" style="padding:5%"> <div >   ');
        popupWin.document.write('<img src="/Content/img/Inventory.png" width="420" height="150"/> ');
        popupWin.document.write('<h3>Products List</h3>  ');

      
        popupWin.document.write('<table class="table table-responsive  table-hover table-bordered" style="font-size:12px" id="print">');
        popupWin.document.write(toPrint.innerHTML);
        popupWin.document.write('</table>');




        popupWin.document.write('</div></body></html>');
        popupWin.document.close();

    });



</script>